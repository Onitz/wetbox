<!DOCTYPE html>
<html>
<head>
<style>
html,body{
  margin:0;
  padding:0;
  font-family:Arial,sans-serif;
  font-size:12px;
}
table{
  border-collapse:collapse;
}
td,th{
  width:15px;
  height:15px;
  border:1px solid #aaa;
  background-color:#fff;
}
tr:last-child, td:first-child{
  color:#aaa;
}
td:last-child {
  background-color:#aaa;
  border:none;
  border-radius:0 15px 0 0;
}
#bestpc{
  font-size:30px;
  font-weight:bold;
  padding:10px;
}
#besttiks{
  width:100%;
  min-height:300px;
}
</style>
</head>
<body><div id="bestpc"></div><textarea id="besttiks"></textarea></body>
<script>
// N CHOOSE K ----------------------------------------------------------------------------------------- 
N = 45;
K = 6;

// -------- buy X tickets ----------------------------------------------------------------------------------------- 
state = null;
X = 66
ITER = 5;

tiks = [  
[1,6,19,22,41,45],[16,18,24,38,43,44],[4,11,19,23,40,44],[2,4,7,20,23,41],[5,16,17,18,40,42],[2,22,27,29,34,40],[7,10,12,15,26,36],[6,13,16,20,36,40],[3,6,12,21,27,39],[21,23,28,29,35,41],[5,7,9,16,22,41],[8,11,13,24,33,45],[2,14,27,31,35,37],[1,11,12,26,30,37],[4,11,13,15,19,37],[2,6,7,18,30,38],[1,16,17,27,30,37],[2,10,17,30,37,38],[4,15,16,31,36,39],[7,8,19,22,25,44],[4,7,16,32,34,37],[3,10,13,15,29,35],[2,9,10,11,23,32],[16,25,27,29,38,42],[7,23,29,34,36,41],[3,12,13,17,23,32],[4,26,27,28,33,42],[6,19,20,25,34,44],[7,9,25,29,34,38],[13,15,17,20,31,37],[4,5,15,22,23,26],[9,11,16,19,23,26],[8,10,15,18,24,25],[14,15,22,23,32,42],[3,15,17,34,35,44],[4,9,13,14,34,45],[3,19,20,27,39,41],[2,12,22,28,35,40],[12,21,22,25,30,44],[13,16,26,30,33,44],[3,7,12,23,42,44],[1,8,19,22,34,40],[1,3,8,9,23,38],[5,9,30,37,40,42],[2,19,36,42,43,45],[17,18,38,40,44,45],[8,11,16,23,39,41],[2,9,21,30,38,39],[6,8,37,38,39,43],[2,3,9,15,33,40],[8,15,18,35,41,42],[3,5,7,29,31,43],[11,20,22,26,39,44],[19,21,25,29,30,45],[20,28,32,33,35,38],[1,7,11,35,39,42],[8,21,28,34,35,43],[4,24,28,32,36,39],[4,14,35,36,38,45],[5,25,26,28,40,45],[2,18,19,26,34,45],[17,25,33,34,35,36],[22,24,26,34,37,42],[1,5,20,21,33,44],[12,13,25,38,41,43],[1,15,16,29,30,31]
];

// Spawn the table
(function proceduallyGenerateTriangle(n) {
  let table = document.createElement("table")
  table.setAttribute('cellpadding',0);
  table.setAttribute('cellspacing',0);
  document.body.prepend(table);

  // Row generation
  for(let i=0;i<(n+2);i++) {
    let row = document.createElement("tr");
    row.setAttribute('id','r'+i)
    table.appendChild(row);

    //r0 and rn+1 are horizontal label rows 
    if( i===0 || i===(n+1)) {
      for(let k=0;k<=(n+1);k++) {
        let cell = document.createElement("td");
        row.appendChild(cell);
        if(k!==0 && k!==(n+1) ) {
          let labl = document.createTextNode(k.toString().padStart(2,'0'));
          cell.appendChild(labl);
        } else if(i===0 && k===(n+1)) {
          cell.style.backgroundColor ='#fff';
        }
      }
      continue;
    }

    // Regular column generation
    for(let j=0;j<=i;j++) { 
      let cell = document.createElement("td");
      row.appendChild(cell);

      if(j===0) {
        let labl = document.createTextNode(i.toString().padStart(2,'0'));
        cell.appendChild(labl);
      }
    }
  }
})(N)


function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;
  while (0 !== currentIndex) {
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }
  return array;
}

function quickpick() {
  for (var a=[],i=0;i<N;++i) a[i]=i+1;
  a = shuffle(a);
  return a.slice(0,K);
}
console.log(quickpick());

function quickpickn(n) {
  tiks = [];
  for(let i=0;i<n;i++) {
    tiks[i] = quickpick();
  }
}

blankSlate = [
  [0],
  [0,0],
  [0,0,0],
  [0,0,0,0],
  [0,0,0,0,0],
  [0,0,0,0,0,0],
  [0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
]; //border of dataset should be all zeros (visually obvious if this cond is broken)

function resetState() {
  state = JSON.parse(JSON.stringify(blankSlate));
}
resetState();

let clashOfColors = [
  'black',
  '#0f0',
  'yellow',
  'orange',
  'red',
];

function computeState() {
  //state = JSON.parse(JSON.stringify(blankSlate)); //force refresh the state

  for(let i=0;i<tiks.length;i++) {
    let tik = tiks[i];
    tik.sort((a,b)=>a-b); //By Default it sorts alphabetically, so will return [11,12,8,9], dumb. add lambda to fix
    // console.log(tik);

    if(tik.length === K) { //tik.length > 1 && tik.length < 8) {
      let a = tik[0];
      let b = tik[1];
      let c = tik[2];
      let d = tik[3];
      let e = tik[4];
      let f = tik[5];
      let g = tik[6];

      if(!a || !b || !c || !d || !e || !f) {
        console.error('UH OH, ZERO TICKET ENTRY')
      }

      state[b][a]++;
      state[c][a]++;
      state[d][a]++;
      state[e][a]++;
      state[c][b]++;
      state[d][b]++;

      state[d][c]++;

      state[e][b]++;
      state[e][c]++;
      state[e][d]++;

      state[f][a]++;
      state[f][b]++;
      state[f][c]++;
      state[f][d]++;
      state[f][e]++;

      if(g) {
        state[g][a]++;
        state[g][b]++;
        state[g][c]++;
        state[g][d]++;
        state[g][e]++;
        state[g][f]++;
      }
    }
  }

}

function drawState() { //drawstate or countstate
  for(let i=0;i<(N+2);i++) { //row iterator
    for(let j=0;j<=i;j++) { //col iterator (init to zero to test lower bound)
      let val = state[i][j];
      let cel = document.getElementById(`r${i}`).children[j];
      cel.style.backgroundColor = clashOfColors[Math.min( val, clashOfColors.length - 1)];
    }
  }
}

function stateCoverage() {
  let ret = 0;
  let k=0;
  for(let i=1;i<(N+1);i++) { //row iterator
    for(let j=1;j<i;j++) { //col iterator (init to zero to test lower bound)
      if(state[i][j]>0) ret++;
      //else console.log('NO COVERAGE AT ',i,j,'(',state[i][j],')');
    }
  }
  //console.log('state coverage=',stateCoverage);
  console.log('',ret,'/',choose(N,2),'=',(100*ret/choose(N,2)).toFixed(2),'%' );
  return ret;
}

function update() { 
  resetState();
  computeState();
}
update();

bestTiks = JSON.parse(JSON.stringify(tiks));
bestStateCoverage = stateCoverage();

function printBest() {
  console.log(JSON.stringify(bestTiks));
}

for(let i=0;i<ITER;i++){
  quickpickn(X);
  update();
  let sc = stateCoverage();
  if(sc > bestStateCoverage) { // we have a new beststate 
    console.log(stateCoverage(),'is better than',bestStateCoverage,'?')
    bestStateCoverage = sc;
    bestTiks = JSON.parse(JSON.stringify(tiks)); //deep copy
  }
}
console.log('-------best');
tiks=bestTiks;
bestpc = ((stateCoverage()/choose(N,2))*100).toFixed(2);
update();
drawState();

document.getElementById('bestpc').innerText = bestpc+'%';
document.getElementById('besttiks').value = JSON.stringify(bestTiks);


//this time its 45 Choose 6 = 45/6*44/5*43/4*42/3*41/2*40/1 = 8 145 060
function choose(n, k) {
  let ret = 1;
  for(let i=1;i<=k;i++){
    ret*=(n-k+i)/i;
  }
  return ret;
}

/*
66 tickets is absolute minimum lower bound for sat 
aka 6C2/45C2 = 15/990 = 66

*/
</script>
</html>